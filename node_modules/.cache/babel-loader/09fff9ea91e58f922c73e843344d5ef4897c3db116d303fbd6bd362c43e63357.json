{"ast":null,"code":"/**\r\n * DevExtreme (esm/__internal/ui/collection/m_collection_widget.live_update.js)\r\n * Version: 24.2.7\r\n * Build date: Mon Apr 28 2025\r\n *\r\n * Copyright (c) 2012 - 2025 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport { indexByKey, insert, update } from \"../../../common/data/array_utils\";\nimport { keysEqual } from \"../../../common/data/utils\";\nimport domAdapter from \"../../../core/dom_adapter\";\nimport $ from \"../../../core/renderer\";\nimport { findChanges } from \"../../../core/utils/array_compare\";\nimport { when } from \"../../../core/utils/deferred\";\nimport { extend } from \"../../../core/utils/extend\";\nimport { each } from \"../../../core/utils/iterator\";\nimport CollectionWidgetAsync from \"../../ui/collection/m_collection_widget.async\";\nconst PRIVATE_KEY_FIELD = \"__dx_key__\";\nclass CollectionWidgetLiveUpdate extends CollectionWidgetAsync {\n  _getDefaultOptions() {\n    return _extends({}, super._getDefaultOptions(), {\n      repaintChangesOnly: false\n    });\n  }\n  _customizeStoreLoadOptions(e) {\n    const dataController = this._dataController;\n    if (dataController.getDataSource() && !this._dataController.isLoaded()) {\n      this._correctionIndex = 0;\n    }\n    if (this._correctionIndex && e.storeLoadOptions) {\n      e.storeLoadOptions.skip += this._correctionIndex;\n    }\n  }\n  reload() {\n    this._correctionIndex = 0;\n  }\n  _init() {\n    super._init();\n    this._refreshItemsCache();\n    this._correctionIndex = 0;\n    this._subscribeLoadOptionsCustomization(true);\n  }\n  _findItemElementByKey(key) {\n    let result = $();\n    const keyExpr = this.key();\n    this.itemElements().each((_, item) => {\n      const $item = $(item);\n      const itemData = this._getItemData($item);\n      if (keyExpr ? keysEqual(keyExpr, this.keyOf(itemData), key) : this._isItemEquals(itemData, key)) {\n        result = $item;\n        return false;\n      }\n    });\n    return result;\n  }\n  _dataSourceChangedHandler(newItems, e) {\n    if (null !== e && void 0 !== e && e.changes) {\n      this._modifyByChanges(e.changes);\n    } else {\n      super._dataSourceChangedHandler(newItems, e);\n      this._refreshItemsCache();\n    }\n  }\n  _isItemEquals(item1, item2) {\n    if (item1 && item1.__dx_key__) {\n      item1 = item1.data;\n    }\n    try {\n      return JSON.stringify(item1) === JSON.stringify(item2);\n    } catch (e) {\n      return item1 === item2;\n    }\n  }\n  _isItemStrictEquals(item1, item2) {\n    return this._isItemEquals(item1, item2);\n  }\n  _shouldAddNewGroup(changes, items) {\n    let result = false;\n    if (this.option(\"grouped\")) {\n      if (!changes.length) {\n        result = true;\n      }\n      each(changes, (i, change) => {\n        if (\"insert\" === change.type) {\n          result = true;\n          each(items, (_, item) => {\n            if (void 0 !== change.data.key && change.data.key === item.key) {\n              result = false;\n              return false;\n            }\n          });\n        }\n      });\n    }\n    return result;\n  }\n  _partialRefresh() {\n    if (this.option(\"repaintChangesOnly\")) {\n      const keyOf = data => {\n        if (data && void 0 !== data.__dx_key__) {\n          return data.__dx_key__;\n        }\n        return this.keyOf(data);\n      };\n      const result = findChanges(this._itemsCache, this._editStrategy.itemsGetter(), keyOf, this._isItemStrictEquals.bind(this));\n      if (result && this._itemsCache.length && !this._shouldAddNewGroup(result, this._itemsCache)) {\n        this._modifyByChanges(result, true);\n        this._renderEmptyMessage();\n        return true;\n      }\n      this._refreshItemsCache();\n    }\n    return false;\n  }\n  _refreshItemsCache() {\n    if (this.option(\"repaintChangesOnly\")) {\n      const items = this._editStrategy.itemsGetter();\n      try {\n        this._itemsCache = extend(true, [], items);\n        if (!this.key()) {\n          this._itemsCache = this._itemsCache.map((itemCache, index) => ({\n            [PRIVATE_KEY_FIELD]: items[index],\n            data: itemCache\n          }));\n        }\n      } catch (e) {\n        this._itemsCache = extend([], items);\n      }\n    }\n  }\n  _dispose() {\n    this._subscribeLoadOptionsCustomization(false);\n    super._dispose();\n  }\n  _updateByChange(keyInfo, items, change, isPartialRefresh) {\n    if (isPartialRefresh) {\n      this._renderItem(change.index, change.data, null, this._findItemElementByKey(change.key));\n    } else {\n      const changedItem = items[indexByKey(keyInfo, items, change.key)];\n      if (changedItem) {\n        update(keyInfo, items, change.key, change.data).done(() => {\n          this._renderItem(items.indexOf(changedItem), changedItem, null, this._findItemElementByKey(change.key));\n        });\n      }\n    }\n  }\n  _insertByChange(keyInfo, items, change, isPartialRefresh) {\n    when(isPartialRefresh || insert(keyInfo, items, change.data, change.index)).done(() => {\n      this._beforeItemElementInserted(change);\n      this._renderItem(change.index ?? items.length, change.data);\n      this._afterItemElementInserted();\n      this._correctionIndex++;\n    });\n  }\n  _updateSelectionAfterRemoveByChange(removeIndex) {\n    const {\n      selectedIndex: selectedIndex,\n      selectedItems: selectedItems\n    } = this.option();\n    if (selectedIndex > removeIndex) {\n      this.option(\"selectedIndex\", selectedIndex - 1);\n    } else if (selectedIndex === removeIndex && 1 === selectedItems.length) {\n      this.option(\"selectedItems\", []);\n    } else {\n      this._normalizeSelectedItems();\n    }\n  }\n  _beforeItemElementInserted(change) {\n    const {\n      selectedIndex: selectedIndex\n    } = this.option();\n    if (change.index <= selectedIndex) {\n      this.option(\"selectedIndex\", selectedIndex + 1);\n    }\n  }\n  _afterItemElementInserted() {\n    this._renderEmptyMessage();\n  }\n  _removeByChange(keyInfo, items, change, isPartialRefresh) {\n    const index = isPartialRefresh ? change.index : indexByKey(keyInfo, items, change.key);\n    const removedItem = isPartialRefresh ? change.oldItem : items[index];\n    if (removedItem) {\n      const $removedItemElement = this._findItemElementByKey(change.key);\n      const deletedActionArgs = this._extendActionArgs($removedItemElement);\n      this._waitDeletingPrepare($removedItemElement).done(() => {\n        if (isPartialRefresh) {\n          this._updateIndicesAfterIndex(index - 1);\n          this._afterItemElementDeleted($removedItemElement, deletedActionArgs);\n          this._updateSelectionAfterRemoveByChange(index);\n        } else {\n          this._deleteItemElementByIndex(index);\n          this._afterItemElementDeleted($removedItemElement, deletedActionArgs);\n        }\n      });\n      this._correctionIndex--;\n    }\n  }\n  _modifyByChanges(changes, isPartialRefresh) {\n    const items = this._editStrategy.itemsGetter();\n    const keyInfo = {\n      key: this.key.bind(this),\n      keyOf: this.keyOf.bind(this)\n    };\n    const dataController = this._dataController;\n    const paginate = dataController.paginate();\n    const group = dataController.group();\n    if (paginate || group) {\n      changes = changes.filter(item => \"insert\" !== item.type || void 0 !== item.index);\n    }\n    changes.forEach(change => this[`_${change.type}ByChange`](keyInfo, items, change, isPartialRefresh));\n    this._renderedItemsCount = items.length;\n    this._refreshItemsCache();\n    this._fireContentReadyAction();\n  }\n  _appendItemToContainer($container, $itemFrame, index) {\n    const nextSiblingElement = $container.children(this._itemSelector()).get(index);\n    domAdapter.insertElement($container.get(0), $itemFrame.get(0), nextSiblingElement);\n  }\n  _subscribeLoadOptionsCustomization(enable) {\n    if (!this._dataController) {\n      return;\n    }\n    if (enable) {\n      this._correctionIndex = 0;\n      this._dataController.on(\"customizeStoreLoadOptions\", this._customizeStoreLoadOptions.bind(this));\n    } else {\n      this._dataController.off(\"customizeStoreLoadOptions\", this._customizeStoreLoadOptions.bind(this));\n    }\n  }\n  _optionChanged(args) {\n    switch (args.name) {\n      case \"items\":\n        {\n          const isItemsUpdated = this._partialRefresh(args.value);\n          if (!isItemsUpdated) {\n            super._optionChanged(args);\n          }\n          break;\n        }\n      case \"dataSource\":\n        if (!this.option(\"repaintChangesOnly\") || !args.value) {\n          this.option(\"items\", []);\n        }\n        this._subscribeLoadOptionsCustomization(false);\n        super._optionChanged(args);\n        this._subscribeLoadOptionsCustomization(true);\n        break;\n      case \"repaintChangesOnly\":\n        break;\n      default:\n        super._optionChanged(args);\n    }\n  }\n}\nexport default CollectionWidgetLiveUpdate;","map":{"version":3,"names":["_extends","indexByKey","insert","update","keysEqual","domAdapter","$","findChanges","when","extend","each","CollectionWidgetAsync","PRIVATE_KEY_FIELD","CollectionWidgetLiveUpdate","_getDefaultOptions","repaintChangesOnly","_customizeStoreLoadOptions","e","dataController","_dataController","getDataSource","isLoaded","_correctionIndex","storeLoadOptions","skip","reload","_init","_refreshItemsCache","_subscribeLoadOptionsCustomization","_findItemElementByKey","key","result","keyExpr","itemElements","_","item","$item","itemData","_getItemData","keyOf","_isItemEquals","_dataSourceChangedHandler","newItems","changes","_modifyByChanges","item1","item2","__dx_key__","data","JSON","stringify","_isItemStrictEquals","_shouldAddNewGroup","items","option","length","i","change","type","_partialRefresh","_itemsCache","_editStrategy","itemsGetter","bind","_renderEmptyMessage","map","itemCache","index","_dispose","_updateByChange","keyInfo","isPartialRefresh","_renderItem","changedItem","done","indexOf","_insertByChange","_beforeItemElementInserted","_afterItemElementInserted","_updateSelectionAfterRemoveByChange","removeIndex","selectedIndex","selectedItems","_normalizeSelectedItems","_removeByChange","removedItem","oldItem","$removedItemElement","deletedActionArgs","_extendActionArgs","_waitDeletingPrepare","_updateIndicesAfterIndex","_afterItemElementDeleted","_deleteItemElementByIndex","paginate","group","filter","forEach","_renderedItemsCount","_fireContentReadyAction","_appendItemToContainer","$container","$itemFrame","nextSiblingElement","children","_itemSelector","get","insertElement","enable","on","off","_optionChanged","args","name","isItemsUpdated","value"],"sources":["/home/nataf/Cours/world-cities-map/client/node_modules/devextreme/esm/__internal/ui/collection/m_collection_widget.live_update.js"],"sourcesContent":["/**\r\n * DevExtreme (esm/__internal/ui/collection/m_collection_widget.live_update.js)\r\n * Version: 24.2.7\r\n * Build date: Mon Apr 28 2025\r\n *\r\n * Copyright (c) 2012 - 2025 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\r\nimport {\r\n    indexByKey,\r\n    insert,\r\n    update\r\n} from \"../../../common/data/array_utils\";\r\nimport {\r\n    keysEqual\r\n} from \"../../../common/data/utils\";\r\nimport domAdapter from \"../../../core/dom_adapter\";\r\nimport $ from \"../../../core/renderer\";\r\nimport {\r\n    findChanges\r\n} from \"../../../core/utils/array_compare\";\r\nimport {\r\n    when\r\n} from \"../../../core/utils/deferred\";\r\nimport {\r\n    extend\r\n} from \"../../../core/utils/extend\";\r\nimport {\r\n    each\r\n} from \"../../../core/utils/iterator\";\r\nimport CollectionWidgetAsync from \"../../ui/collection/m_collection_widget.async\";\r\nconst PRIVATE_KEY_FIELD = \"__dx_key__\";\r\nclass CollectionWidgetLiveUpdate extends CollectionWidgetAsync {\r\n    _getDefaultOptions() {\r\n        return _extends({}, super._getDefaultOptions(), {\r\n            repaintChangesOnly: false\r\n        })\r\n    }\r\n    _customizeStoreLoadOptions(e) {\r\n        const dataController = this._dataController;\r\n        if (dataController.getDataSource() && !this._dataController.isLoaded()) {\r\n            this._correctionIndex = 0\r\n        }\r\n        if (this._correctionIndex && e.storeLoadOptions) {\r\n            e.storeLoadOptions.skip += this._correctionIndex\r\n        }\r\n    }\r\n    reload() {\r\n        this._correctionIndex = 0\r\n    }\r\n    _init() {\r\n        super._init();\r\n        this._refreshItemsCache();\r\n        this._correctionIndex = 0;\r\n        this._subscribeLoadOptionsCustomization(true)\r\n    }\r\n    _findItemElementByKey(key) {\r\n        let result = $();\r\n        const keyExpr = this.key();\r\n        this.itemElements().each(((_, item) => {\r\n            const $item = $(item);\r\n            const itemData = this._getItemData($item);\r\n            if (keyExpr ? keysEqual(keyExpr, this.keyOf(itemData), key) : this._isItemEquals(itemData, key)) {\r\n                result = $item;\r\n                return false\r\n            }\r\n        }));\r\n        return result\r\n    }\r\n    _dataSourceChangedHandler(newItems, e) {\r\n        if (null !== e && void 0 !== e && e.changes) {\r\n            this._modifyByChanges(e.changes)\r\n        } else {\r\n            super._dataSourceChangedHandler(newItems, e);\r\n            this._refreshItemsCache()\r\n        }\r\n    }\r\n    _isItemEquals(item1, item2) {\r\n        if (item1 && item1.__dx_key__) {\r\n            item1 = item1.data\r\n        }\r\n        try {\r\n            return JSON.stringify(item1) === JSON.stringify(item2)\r\n        } catch (e) {\r\n            return item1 === item2\r\n        }\r\n    }\r\n    _isItemStrictEquals(item1, item2) {\r\n        return this._isItemEquals(item1, item2)\r\n    }\r\n    _shouldAddNewGroup(changes, items) {\r\n        let result = false;\r\n        if (this.option(\"grouped\")) {\r\n            if (!changes.length) {\r\n                result = true\r\n            }\r\n            each(changes, ((i, change) => {\r\n                if (\"insert\" === change.type) {\r\n                    result = true;\r\n                    each(items, ((_, item) => {\r\n                        if (void 0 !== change.data.key && change.data.key === item.key) {\r\n                            result = false;\r\n                            return false\r\n                        }\r\n                    }))\r\n                }\r\n            }))\r\n        }\r\n        return result\r\n    }\r\n    _partialRefresh() {\r\n        if (this.option(\"repaintChangesOnly\")) {\r\n            const keyOf = data => {\r\n                if (data && void 0 !== data.__dx_key__) {\r\n                    return data.__dx_key__\r\n                }\r\n                return this.keyOf(data)\r\n            };\r\n            const result = findChanges(this._itemsCache, this._editStrategy.itemsGetter(), keyOf, this._isItemStrictEquals.bind(this));\r\n            if (result && this._itemsCache.length && !this._shouldAddNewGroup(result, this._itemsCache)) {\r\n                this._modifyByChanges(result, true);\r\n                this._renderEmptyMessage();\r\n                return true\r\n            }\r\n            this._refreshItemsCache()\r\n        }\r\n        return false\r\n    }\r\n    _refreshItemsCache() {\r\n        if (this.option(\"repaintChangesOnly\")) {\r\n            const items = this._editStrategy.itemsGetter();\r\n            try {\r\n                this._itemsCache = extend(true, [], items);\r\n                if (!this.key()) {\r\n                    this._itemsCache = this._itemsCache.map(((itemCache, index) => ({\r\n                        [PRIVATE_KEY_FIELD]: items[index],\r\n                        data: itemCache\r\n                    })))\r\n                }\r\n            } catch (e) {\r\n                this._itemsCache = extend([], items)\r\n            }\r\n        }\r\n    }\r\n    _dispose() {\r\n        this._subscribeLoadOptionsCustomization(false);\r\n        super._dispose()\r\n    }\r\n    _updateByChange(keyInfo, items, change, isPartialRefresh) {\r\n        if (isPartialRefresh) {\r\n            this._renderItem(change.index, change.data, null, this._findItemElementByKey(change.key))\r\n        } else {\r\n            const changedItem = items[indexByKey(keyInfo, items, change.key)];\r\n            if (changedItem) {\r\n                update(keyInfo, items, change.key, change.data).done((() => {\r\n                    this._renderItem(items.indexOf(changedItem), changedItem, null, this._findItemElementByKey(change.key))\r\n                }))\r\n            }\r\n        }\r\n    }\r\n    _insertByChange(keyInfo, items, change, isPartialRefresh) {\r\n        when(isPartialRefresh || insert(keyInfo, items, change.data, change.index)).done((() => {\r\n            this._beforeItemElementInserted(change);\r\n            this._renderItem(change.index ?? items.length, change.data);\r\n            this._afterItemElementInserted();\r\n            this._correctionIndex++\r\n        }))\r\n    }\r\n    _updateSelectionAfterRemoveByChange(removeIndex) {\r\n        const {\r\n            selectedIndex: selectedIndex,\r\n            selectedItems: selectedItems\r\n        } = this.option();\r\n        if (selectedIndex > removeIndex) {\r\n            this.option(\"selectedIndex\", selectedIndex - 1)\r\n        } else if (selectedIndex === removeIndex && 1 === selectedItems.length) {\r\n            this.option(\"selectedItems\", [])\r\n        } else {\r\n            this._normalizeSelectedItems()\r\n        }\r\n    }\r\n    _beforeItemElementInserted(change) {\r\n        const {\r\n            selectedIndex: selectedIndex\r\n        } = this.option();\r\n        if (change.index <= selectedIndex) {\r\n            this.option(\"selectedIndex\", selectedIndex + 1)\r\n        }\r\n    }\r\n    _afterItemElementInserted() {\r\n        this._renderEmptyMessage()\r\n    }\r\n    _removeByChange(keyInfo, items, change, isPartialRefresh) {\r\n        const index = isPartialRefresh ? change.index : indexByKey(keyInfo, items, change.key);\r\n        const removedItem = isPartialRefresh ? change.oldItem : items[index];\r\n        if (removedItem) {\r\n            const $removedItemElement = this._findItemElementByKey(change.key);\r\n            const deletedActionArgs = this._extendActionArgs($removedItemElement);\r\n            this._waitDeletingPrepare($removedItemElement).done((() => {\r\n                if (isPartialRefresh) {\r\n                    this._updateIndicesAfterIndex(index - 1);\r\n                    this._afterItemElementDeleted($removedItemElement, deletedActionArgs);\r\n                    this._updateSelectionAfterRemoveByChange(index)\r\n                } else {\r\n                    this._deleteItemElementByIndex(index);\r\n                    this._afterItemElementDeleted($removedItemElement, deletedActionArgs)\r\n                }\r\n            }));\r\n            this._correctionIndex--\r\n        }\r\n    }\r\n    _modifyByChanges(changes, isPartialRefresh) {\r\n        const items = this._editStrategy.itemsGetter();\r\n        const keyInfo = {\r\n            key: this.key.bind(this),\r\n            keyOf: this.keyOf.bind(this)\r\n        };\r\n        const dataController = this._dataController;\r\n        const paginate = dataController.paginate();\r\n        const group = dataController.group();\r\n        if (paginate || group) {\r\n            changes = changes.filter((item => \"insert\" !== item.type || void 0 !== item.index))\r\n        }\r\n        changes.forEach((change => this[`_${change.type}ByChange`](keyInfo, items, change, isPartialRefresh)));\r\n        this._renderedItemsCount = items.length;\r\n        this._refreshItemsCache();\r\n        this._fireContentReadyAction()\r\n    }\r\n    _appendItemToContainer($container, $itemFrame, index) {\r\n        const nextSiblingElement = $container.children(this._itemSelector()).get(index);\r\n        domAdapter.insertElement($container.get(0), $itemFrame.get(0), nextSiblingElement)\r\n    }\r\n    _subscribeLoadOptionsCustomization(enable) {\r\n        if (!this._dataController) {\r\n            return\r\n        }\r\n        if (enable) {\r\n            this._correctionIndex = 0;\r\n            this._dataController.on(\"customizeStoreLoadOptions\", this._customizeStoreLoadOptions.bind(this))\r\n        } else {\r\n            this._dataController.off(\"customizeStoreLoadOptions\", this._customizeStoreLoadOptions.bind(this))\r\n        }\r\n    }\r\n    _optionChanged(args) {\r\n        switch (args.name) {\r\n            case \"items\": {\r\n                const isItemsUpdated = this._partialRefresh(args.value);\r\n                if (!isItemsUpdated) {\r\n                    super._optionChanged(args)\r\n                }\r\n                break\r\n            }\r\n            case \"dataSource\":\r\n                if (!this.option(\"repaintChangesOnly\") || !args.value) {\r\n                    this.option(\"items\", [])\r\n                }\r\n                this._subscribeLoadOptionsCustomization(false);\r\n                super._optionChanged(args);\r\n                this._subscribeLoadOptionsCustomization(true);\r\n                break;\r\n            case \"repaintChangesOnly\":\r\n                break;\r\n            default:\r\n                super._optionChanged(args)\r\n        }\r\n    }\r\n}\r\nexport default CollectionWidgetLiveUpdate;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}