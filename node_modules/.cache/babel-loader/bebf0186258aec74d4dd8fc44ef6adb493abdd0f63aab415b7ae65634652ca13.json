{"ast":null,"code":"/**\r\n * DevExtreme (esm/__internal/core/templates/m_bindable_template.js)\r\n * Version: 24.2.7\r\n * Build date: Mon Apr 28 2025\r\n *\r\n * Copyright (c) 2012 - 2025 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport eventsEngine from \"../../../common/core/events/core/events_engine\";\nimport { removeEvent } from \"../../../common/core/events/remove\";\nimport $ from \"../../../core/renderer\";\nimport { TemplateBase } from \"../../../core/templates/template_base\";\nimport { isPrimitive } from \"../../../core/utils/type\";\nconst watchChanges = function (rawData, watchMethod, fields, fieldsMap, callback) {\n  let fieldsDispose;\n  const globalDispose = ((data, watchMethod, callback) => watchMethod(() => data, callback))(rawData, watchMethod, dataWithRawFields => {\n    fieldsDispose && fieldsDispose();\n    if (isPrimitive(dataWithRawFields)) {\n      callback(dataWithRawFields);\n      return;\n    }\n    fieldsDispose = function (data, watchMethod, fields, fieldsMap, callback) {\n      const resolvedData = {};\n      const missedFields = fields.slice();\n      const watchHandlers = fields.map(name => {\n        const fieldGetter = fieldsMap[name];\n        return watchMethod(fieldGetter ? () => fieldGetter(data) : () => data[name], value => {\n          resolvedData[name] = value;\n          if (missedFields.length) {\n            const index = missedFields.indexOf(name);\n            if (index >= 0) {\n              missedFields.splice(index, 1);\n            }\n          }\n          if (!missedFields.length) {\n            callback(resolvedData);\n          }\n        });\n      });\n      return function () {\n        watchHandlers.forEach(dispose => dispose());\n      };\n    }(dataWithRawFields, watchMethod, fields, fieldsMap, callback);\n  });\n  return function () {\n    fieldsDispose && fieldsDispose();\n    globalDispose && globalDispose();\n  };\n};\nexport class BindableTemplate extends TemplateBase {\n  constructor(render, fields, watchMethod, fieldsMap) {\n    super();\n    this._render = render;\n    this._fields = fields;\n    this._fieldsMap = fieldsMap || {};\n    this._watchMethod = watchMethod;\n  }\n  _renderCore(options) {\n    const $container = $(options.container);\n    const dispose = watchChanges(options.model, this._watchMethod, this._fields, this._fieldsMap, data => {\n      $container.empty();\n      this._render($container, data, options.model);\n    });\n    eventsEngine.on($container, removeEvent, dispose);\n    return $container.contents();\n  }\n}","map":{"version":3,"names":["eventsEngine","removeEvent","$","TemplateBase","isPrimitive","watchChanges","rawData","watchMethod","fields","fieldsMap","callback","fieldsDispose","globalDispose","data","dataWithRawFields","resolvedData","missedFields","slice","watchHandlers","map","name","fieldGetter","value","length","index","indexOf","splice","forEach","dispose","BindableTemplate","constructor","render","_render","_fields","_fieldsMap","_watchMethod","_renderCore","options","$container","container","model","empty","on","contents"],"sources":["/home/nataf/Cours/world-cities-map/client/node_modules/devextreme/esm/__internal/core/templates/m_bindable_template.js"],"sourcesContent":["/**\r\n * DevExtreme (esm/__internal/core/templates/m_bindable_template.js)\r\n * Version: 24.2.7\r\n * Build date: Mon Apr 28 2025\r\n *\r\n * Copyright (c) 2012 - 2025 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport eventsEngine from \"../../../common/core/events/core/events_engine\";\r\nimport {\r\n    removeEvent\r\n} from \"../../../common/core/events/remove\";\r\nimport $ from \"../../../core/renderer\";\r\nimport {\r\n    TemplateBase\r\n} from \"../../../core/templates/template_base\";\r\nimport {\r\n    isPrimitive\r\n} from \"../../../core/utils/type\";\r\nconst watchChanges = function(rawData, watchMethod, fields, fieldsMap, callback) {\r\n    let fieldsDispose;\r\n    const globalDispose = ((data, watchMethod, callback) => watchMethod((() => data), callback))(rawData, watchMethod, (dataWithRawFields => {\r\n        fieldsDispose && fieldsDispose();\r\n        if (isPrimitive(dataWithRawFields)) {\r\n            callback(dataWithRawFields);\r\n            return\r\n        }\r\n        fieldsDispose = function(data, watchMethod, fields, fieldsMap, callback) {\r\n            const resolvedData = {};\r\n            const missedFields = fields.slice();\r\n            const watchHandlers = fields.map((name => {\r\n                const fieldGetter = fieldsMap[name];\r\n                return watchMethod(fieldGetter ? () => fieldGetter(data) : () => data[name], (value => {\r\n                    resolvedData[name] = value;\r\n                    if (missedFields.length) {\r\n                        const index = missedFields.indexOf(name);\r\n                        if (index >= 0) {\r\n                            missedFields.splice(index, 1)\r\n                        }\r\n                    }\r\n                    if (!missedFields.length) {\r\n                        callback(resolvedData)\r\n                    }\r\n                }))\r\n            }));\r\n            return function() {\r\n                watchHandlers.forEach((dispose => dispose()))\r\n            }\r\n        }(dataWithRawFields, watchMethod, fields, fieldsMap, callback)\r\n    }));\r\n    return function() {\r\n        fieldsDispose && fieldsDispose();\r\n        globalDispose && globalDispose()\r\n    }\r\n};\r\nexport class BindableTemplate extends TemplateBase {\r\n    constructor(render, fields, watchMethod, fieldsMap) {\r\n        super();\r\n        this._render = render;\r\n        this._fields = fields;\r\n        this._fieldsMap = fieldsMap || {};\r\n        this._watchMethod = watchMethod\r\n    }\r\n    _renderCore(options) {\r\n        const $container = $(options.container);\r\n        const dispose = watchChanges(options.model, this._watchMethod, this._fields, this._fieldsMap, (data => {\r\n            $container.empty();\r\n            this._render($container, data, options.model)\r\n        }));\r\n        eventsEngine.on($container, removeEvent, dispose);\r\n        return $container.contents()\r\n    }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}