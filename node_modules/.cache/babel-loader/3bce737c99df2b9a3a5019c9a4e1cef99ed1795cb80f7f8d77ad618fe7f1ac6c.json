{"ast":null,"code":"/**\r\n * DevExtreme (esm/__internal/ui/collection/m_search_box_mixin.js)\r\n * Version: 24.2.7\r\n * Build date: Mon Apr 28 2025\r\n *\r\n * Copyright (c) 2012 - 2025 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport messageLocalization from \"../../../common/core/localization/message\";\nimport $ from \"../../../core/renderer\";\nimport { Deferred } from \"../../../core/utils/deferred\";\nimport { extend } from \"../../../core/utils/extend\";\nimport { stubComponent } from \"../../../core/utils/stubs\";\nimport errors from \"../../../ui/widget/ui.errors\";\nlet EditorClass = stubComponent(\"TextBox\");\nexport default {\n  _getDefaultOptions() {\n    return extend(this.callBase(), {\n      searchMode: \"\",\n      searchExpr: null,\n      searchValue: \"\",\n      searchEnabled: false,\n      searchEditorOptions: {}\n    });\n  },\n  _initMarkup() {\n    this._renderSearch();\n    this.callBase();\n  },\n  _renderSearch() {\n    const $element = this.$element();\n    const searchEnabled = this.option(\"searchEnabled\");\n    const searchBoxClassName = this._addWidgetPrefix(\"search\");\n    const rootElementClassName = this._addWidgetPrefix(\"with-search\");\n    if (!searchEnabled) {\n      $element.removeClass(rootElementClassName);\n      this._removeSearchBox();\n      return;\n    }\n    const editorOptions = this._getSearchEditorOptions();\n    if (this._searchEditor) {\n      this._searchEditor.option(editorOptions);\n    } else {\n      $element.addClass(rootElementClassName);\n      this._$searchEditorElement = $(\"<div>\").addClass(searchBoxClassName).prependTo($element);\n      this._searchEditor = this._createComponent(this._$searchEditorElement, EditorClass, editorOptions);\n    }\n  },\n  _removeSearchBox() {\n    this._$searchEditorElement && this._$searchEditorElement.remove();\n    delete this._$searchEditorElement;\n    delete this._searchEditor;\n  },\n  _getSearchEditorOptions() {\n    const that = this;\n    const userEditorOptions = that.option(\"searchEditorOptions\");\n    const searchText = messageLocalization.format(\"Search\");\n    return extend({\n      mode: \"search\",\n      placeholder: searchText,\n      tabIndex: that.option(\"tabIndex\"),\n      value: that.option(\"searchValue\"),\n      valueChangeEvent: \"input\",\n      inputAttr: {\n        \"aria-label\": searchText\n      },\n      onValueChanged(e) {\n        const searchTimeout = that.option(\"searchTimeout\");\n        that._valueChangeDeferred = Deferred();\n        clearTimeout(that._valueChangeTimeout);\n        that._valueChangeDeferred.done(function () {\n          this.option(\"searchValue\", e.value);\n        }.bind(that));\n        if (e.event && \"input\" === e.event.type && searchTimeout) {\n          that._valueChangeTimeout = setTimeout(() => {\n            that._valueChangeDeferred.resolve();\n          }, searchTimeout);\n        } else {\n          that._valueChangeDeferred.resolve();\n        }\n      }\n    }, userEditorOptions);\n  },\n  _getAriaTarget() {\n    if (this.option(\"searchEnabled\")) {\n      return this._itemContainer(true);\n    }\n    return this.callBase();\n  },\n  _focusTarget() {\n    if (this.option(\"searchEnabled\")) {\n      return this._itemContainer(true);\n    }\n    return this.callBase();\n  },\n  _updateFocusState(e, isFocused) {\n    if (this.option(\"searchEnabled\")) {\n      this._toggleFocusClass(isFocused, this.$element());\n    }\n    this.callBase(e, isFocused);\n  },\n  getOperationBySearchMode: searchMode => \"equals\" === searchMode ? \"=\" : searchMode,\n  _optionChanged(args) {\n    switch (args.name) {\n      case \"searchEnabled\":\n      case \"searchEditorOptions\":\n        this._invalidate();\n        break;\n      case \"searchExpr\":\n      case \"searchMode\":\n      case \"searchValue\":\n        if (!this._dataSource) {\n          errors.log(\"W1009\");\n          return;\n        }\n        if (\"searchMode\" === args.name) {\n          this._dataSource.searchOperation(this.getOperationBySearchMode(args.value));\n        } else {\n          this._dataSource[args.name](args.value);\n        }\n        this._dataSource.load();\n        break;\n      case \"searchTimeout\":\n        break;\n      default:\n        this.callBase(args);\n    }\n  },\n  focus() {\n    if (!this.option(\"focusedElement\") && this.option(\"searchEnabled\")) {\n      this._searchEditor && this._searchEditor.focus();\n      return;\n    }\n    this.callBase();\n  },\n  _cleanAria() {\n    const $element = this.$element();\n    this.setAria({\n      role: null,\n      activedescendant: null\n    }, $element);\n    $element.attr(\"tabIndex\", null);\n  },\n  _clean() {\n    this.callBase();\n    this._cleanAria();\n  },\n  _refresh() {\n    if (this._valueChangeDeferred) {\n      this._valueChangeDeferred.resolve();\n    }\n    this.callBase();\n  },\n  setEditorClass(value) {\n    EditorClass = value;\n  }\n};","map":{"version":3,"names":["messageLocalization","$","Deferred","extend","stubComponent","errors","EditorClass","_getDefaultOptions","callBase","searchMode","searchExpr","searchValue","searchEnabled","searchEditorOptions","_initMarkup","_renderSearch","$element","option","searchBoxClassName","_addWidgetPrefix","rootElementClassName","removeClass","_removeSearchBox","editorOptions","_getSearchEditorOptions","_searchEditor","addClass","_$searchEditorElement","prependTo","_createComponent","remove","that","userEditorOptions","searchText","format","mode","placeholder","tabIndex","value","valueChangeEvent","inputAttr","onValueChanged","e","searchTimeout","_valueChangeDeferred","clearTimeout","_valueChangeTimeout","done","bind","event","type","setTimeout","resolve","_getAriaTarget","_itemContainer","_focusTarget","_updateFocusState","isFocused","_toggleFocusClass","getOperationBySearchMode","_optionChanged","args","name","_invalidate","_dataSource","log","searchOperation","load","focus","_cleanAria","setAria","role","activedescendant","attr","_clean","_refresh","setEditorClass"],"sources":["/home/nataf/Cours/world-cities-map/client/node_modules/devextreme/esm/__internal/ui/collection/m_search_box_mixin.js"],"sourcesContent":["/**\r\n * DevExtreme (esm/__internal/ui/collection/m_search_box_mixin.js)\r\n * Version: 24.2.7\r\n * Build date: Mon Apr 28 2025\r\n *\r\n * Copyright (c) 2012 - 2025 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport messageLocalization from \"../../../common/core/localization/message\";\r\nimport $ from \"../../../core/renderer\";\r\nimport {\r\n    Deferred\r\n} from \"../../../core/utils/deferred\";\r\nimport {\r\n    extend\r\n} from \"../../../core/utils/extend\";\r\nimport {\r\n    stubComponent\r\n} from \"../../../core/utils/stubs\";\r\nimport errors from \"../../../ui/widget/ui.errors\";\r\nlet EditorClass = stubComponent(\"TextBox\");\r\nexport default {\r\n    _getDefaultOptions() {\r\n        return extend(this.callBase(), {\r\n            searchMode: \"\",\r\n            searchExpr: null,\r\n            searchValue: \"\",\r\n            searchEnabled: false,\r\n            searchEditorOptions: {}\r\n        })\r\n    },\r\n    _initMarkup() {\r\n        this._renderSearch();\r\n        this.callBase()\r\n    },\r\n    _renderSearch() {\r\n        const $element = this.$element();\r\n        const searchEnabled = this.option(\"searchEnabled\");\r\n        const searchBoxClassName = this._addWidgetPrefix(\"search\");\r\n        const rootElementClassName = this._addWidgetPrefix(\"with-search\");\r\n        if (!searchEnabled) {\r\n            $element.removeClass(rootElementClassName);\r\n            this._removeSearchBox();\r\n            return\r\n        }\r\n        const editorOptions = this._getSearchEditorOptions();\r\n        if (this._searchEditor) {\r\n            this._searchEditor.option(editorOptions)\r\n        } else {\r\n            $element.addClass(rootElementClassName);\r\n            this._$searchEditorElement = $(\"<div>\").addClass(searchBoxClassName).prependTo($element);\r\n            this._searchEditor = this._createComponent(this._$searchEditorElement, EditorClass, editorOptions)\r\n        }\r\n    },\r\n    _removeSearchBox() {\r\n        this._$searchEditorElement && this._$searchEditorElement.remove();\r\n        delete this._$searchEditorElement;\r\n        delete this._searchEditor\r\n    },\r\n    _getSearchEditorOptions() {\r\n        const that = this;\r\n        const userEditorOptions = that.option(\"searchEditorOptions\");\r\n        const searchText = messageLocalization.format(\"Search\");\r\n        return extend({\r\n            mode: \"search\",\r\n            placeholder: searchText,\r\n            tabIndex: that.option(\"tabIndex\"),\r\n            value: that.option(\"searchValue\"),\r\n            valueChangeEvent: \"input\",\r\n            inputAttr: {\r\n                \"aria-label\": searchText\r\n            },\r\n            onValueChanged(e) {\r\n                const searchTimeout = that.option(\"searchTimeout\");\r\n                that._valueChangeDeferred = Deferred();\r\n                clearTimeout(that._valueChangeTimeout);\r\n                that._valueChangeDeferred.done(function() {\r\n                    this.option(\"searchValue\", e.value)\r\n                }.bind(that));\r\n                if (e.event && \"input\" === e.event.type && searchTimeout) {\r\n                    that._valueChangeTimeout = setTimeout((() => {\r\n                        that._valueChangeDeferred.resolve()\r\n                    }), searchTimeout)\r\n                } else {\r\n                    that._valueChangeDeferred.resolve()\r\n                }\r\n            }\r\n        }, userEditorOptions)\r\n    },\r\n    _getAriaTarget() {\r\n        if (this.option(\"searchEnabled\")) {\r\n            return this._itemContainer(true)\r\n        }\r\n        return this.callBase()\r\n    },\r\n    _focusTarget() {\r\n        if (this.option(\"searchEnabled\")) {\r\n            return this._itemContainer(true)\r\n        }\r\n        return this.callBase()\r\n    },\r\n    _updateFocusState(e, isFocused) {\r\n        if (this.option(\"searchEnabled\")) {\r\n            this._toggleFocusClass(isFocused, this.$element())\r\n        }\r\n        this.callBase(e, isFocused)\r\n    },\r\n    getOperationBySearchMode: searchMode => \"equals\" === searchMode ? \"=\" : searchMode,\r\n    _optionChanged(args) {\r\n        switch (args.name) {\r\n            case \"searchEnabled\":\r\n            case \"searchEditorOptions\":\r\n                this._invalidate();\r\n                break;\r\n            case \"searchExpr\":\r\n            case \"searchMode\":\r\n            case \"searchValue\":\r\n                if (!this._dataSource) {\r\n                    errors.log(\"W1009\");\r\n                    return\r\n                }\r\n                if (\"searchMode\" === args.name) {\r\n                    this._dataSource.searchOperation(this.getOperationBySearchMode(args.value))\r\n                } else {\r\n                    this._dataSource[args.name](args.value)\r\n                }\r\n                this._dataSource.load();\r\n                break;\r\n            case \"searchTimeout\":\r\n                break;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    },\r\n    focus() {\r\n        if (!this.option(\"focusedElement\") && this.option(\"searchEnabled\")) {\r\n            this._searchEditor && this._searchEditor.focus();\r\n            return\r\n        }\r\n        this.callBase()\r\n    },\r\n    _cleanAria() {\r\n        const $element = this.$element();\r\n        this.setAria({\r\n            role: null,\r\n            activedescendant: null\r\n        }, $element);\r\n        $element.attr(\"tabIndex\", null)\r\n    },\r\n    _clean() {\r\n        this.callBase();\r\n        this._cleanAria()\r\n    },\r\n    _refresh() {\r\n        if (this._valueChangeDeferred) {\r\n            this._valueChangeDeferred.resolve()\r\n        }\r\n        this.callBase()\r\n    },\r\n    setEditorClass(value) {\r\n        EditorClass = value\r\n    }\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}