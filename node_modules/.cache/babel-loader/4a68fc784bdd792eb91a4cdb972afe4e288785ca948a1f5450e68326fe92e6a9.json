{"ast":null,"code":"/**\r\n * DevExtreme (esm/__internal/data/data_source/m_data_source.js)\r\n * Version: 24.2.7\r\n * Build date: Mon Apr 28 2025\r\n *\r\n * Copyright (c) 2012 - 2025 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport { applyBatch } from \"../../../common/data/array_utils\";\nimport { CustomStore } from \"../../../common/data/custom_store\";\nimport OperationManager from \"../../../common/data/data_source/operation_manager\";\nimport { CANCELED_TOKEN, isPending, mapDataRespectingGrouping, normalizeDataSourceOptions, normalizeLoadResult, normalizeStoreLoadOptionAccessorArguments } from \"../../../common/data/data_source/utils\";\nimport { errors } from \"../../../common/data/errors\";\nimport { throttleChanges } from \"../../../common/data/utils\";\nimport Class from \"../../../core/class\";\nimport { EventsStrategy } from \"../../../core/events_strategy\";\nimport { Deferred, when } from \"../../../core/utils/deferred\";\nimport { extend } from \"../../../core/utils/extend\";\nimport { each } from \"../../../core/utils/iterator\";\nimport { create } from \"../../../core/utils/queue\";\nimport { isBoolean, isDefined, isEmptyObject, isNumeric, isObject, isString } from \"../../../core/utils/type\";\nimport commonUtils from \"../../core/utils/m_common\";\nexport const DataSource = Class.inherit({\n  ctor(options) {\n    options = normalizeDataSourceOptions(options);\n    this._eventsStrategy = new EventsStrategy(this, {\n      syncStrategy: true\n    });\n    this._store = options.store;\n    this._changedTime = 0;\n    const needThrottling = 0 !== options.pushAggregationTimeout;\n    if (needThrottling) {\n      const throttlingTimeout = void 0 === options.pushAggregationTimeout ? () => 5 * this._changedTime : options.pushAggregationTimeout;\n      let pushDeferred;\n      let lastPushWaiters;\n      const throttlingPushHandler = throttleChanges(changes => {\n        pushDeferred.resolve();\n        const storePushPending = when(...lastPushWaiters);\n        storePushPending.done(() => this._onPush(changes));\n        lastPushWaiters = void 0;\n        pushDeferred = void 0;\n      }, throttlingTimeout);\n      this._onPushHandler = args => {\n        this._aggregationTimeoutId = throttlingPushHandler(args.changes);\n        if (!pushDeferred) {\n          pushDeferred = new Deferred();\n        }\n        lastPushWaiters = args.waitFor;\n        args.waitFor.push(pushDeferred.promise());\n      };\n      this._store.on(\"beforePushAggregation\", this._onPushHandler);\n    } else {\n      this._onPushHandler = changes => this._onPush(changes);\n      this._store.on(\"push\", this._onPushHandler);\n    }\n    this._storeLoadOptions = this._extractLoadOptions(options);\n    this._mapFunc = options.map;\n    this._postProcessFunc = options.postProcess;\n    this._pageIndex = void 0 !== options.pageIndex ? options.pageIndex : 0;\n    this._pageSize = void 0 !== options.pageSize ? options.pageSize : 20;\n    this._loadingCount = 0;\n    this._loadQueue = this._createLoadQueue();\n    this._searchValue = \"searchValue\" in options ? options.searchValue : null;\n    this._searchOperation = options.searchOperation || \"contains\";\n    this._searchExpr = options.searchExpr;\n    this._paginate = options.paginate;\n    this._reshapeOnPush = options.reshapeOnPush ?? false;\n    each([\"onChanged\", \"onLoadError\", \"onLoadingChanged\", \"onCustomizeLoadResult\", \"onCustomizeStoreLoadOptions\"], (_, optionName) => {\n      if (optionName in options) {\n        this.on(optionName.substr(2, 1).toLowerCase() + optionName.substr(3), options[optionName]);\n      }\n    });\n    this._operationManager = new OperationManager();\n    this._init();\n  },\n  _init() {\n    this._items = [];\n    this._userData = {};\n    this._totalCount = -1;\n    this._isLoaded = false;\n    if (!isDefined(this._paginate)) {\n      this._paginate = !this.group();\n    }\n    this._isLastPage = !this._paginate;\n  },\n  dispose() {\n    var _this$_delayedLoadTas;\n    this._store.off(\"beforePushAggregation\", this._onPushHandler);\n    this._store.off(\"push\", this._onPushHandler);\n    this._eventsStrategy.dispose();\n    clearTimeout(this._aggregationTimeoutId);\n    null === (_this$_delayedLoadTas = this._delayedLoadTask) || void 0 === _this$_delayedLoadTas || _this$_delayedLoadTas.abort();\n    this._operationManager.cancelAll();\n    delete this._store;\n    delete this._items;\n    delete this._delayedLoadTask;\n    this._disposed = true;\n  },\n  _extractLoadOptions(options) {\n    const result = {};\n    let names = [\"sort\", \"filter\", \"langParams\", \"select\", \"group\", \"requireTotalCount\"];\n    const customNames = this._store._customLoadOptions();\n    if (customNames) {\n      names = names.concat(customNames);\n    }\n    each(names, function () {\n      result[this] = options[this];\n    });\n    return result;\n  },\n  loadOptions() {\n    return this._storeLoadOptions;\n  },\n  items() {\n    return this._items;\n  },\n  pageIndex(newIndex) {\n    if (!isNumeric(newIndex)) {\n      return this._pageIndex;\n    }\n    this._pageIndex = newIndex;\n    this._isLastPage = !this._paginate;\n  },\n  paginate(value) {\n    if (!isBoolean(value)) {\n      return this._paginate;\n    }\n    if (this._paginate !== value) {\n      this._paginate = value;\n      this.pageIndex(0);\n    }\n  },\n  pageSize(value) {\n    if (!isNumeric(value)) {\n      return this._pageSize;\n    }\n    this._pageSize = value;\n  },\n  isLastPage() {\n    return this._isLastPage;\n  },\n  generateStoreLoadOptionAccessor(optionName) {\n    return args => {\n      const normalizedArgs = normalizeStoreLoadOptionAccessorArguments(args);\n      if (void 0 === normalizedArgs) {\n        return this._storeLoadOptions[optionName];\n      }\n      this._storeLoadOptions[optionName] = normalizedArgs;\n    };\n  },\n  sort() {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    return this.generateStoreLoadOptionAccessor(\"sort\")(args);\n  },\n  filter() {\n    const newFilter = normalizeStoreLoadOptionAccessorArguments(arguments);\n    if (void 0 === newFilter) {\n      return this._storeLoadOptions.filter;\n    }\n    this._storeLoadOptions.filter = newFilter;\n    this.pageIndex(0);\n  },\n  group() {\n    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n    return this.generateStoreLoadOptionAccessor(\"group\")(args);\n  },\n  select() {\n    for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n      args[_key3] = arguments[_key3];\n    }\n    return this.generateStoreLoadOptionAccessor(\"select\")(args);\n  },\n  requireTotalCount(value) {\n    if (!isBoolean(value)) {\n      return this._storeLoadOptions.requireTotalCount;\n    }\n    this._storeLoadOptions.requireTotalCount = value;\n  },\n  searchValue(value) {\n    if (arguments.length < 1) {\n      return this._searchValue;\n    }\n    this._searchValue = value;\n    this.pageIndex(0);\n  },\n  searchOperation(op) {\n    if (!isString(op)) {\n      return this._searchOperation;\n    }\n    this._searchOperation = op;\n    this.pageIndex(0);\n  },\n  searchExpr(expr) {\n    const argc = arguments.length;\n    if (0 === argc) {\n      return this._searchExpr;\n    }\n    if (argc > 1) {\n      expr = [].slice.call(arguments);\n    }\n    this._searchExpr = expr;\n    this.pageIndex(0);\n  },\n  store() {\n    return this._store;\n  },\n  key() {\n    var _this$_store;\n    return null === (_this$_store = this._store) || void 0 === _this$_store ? void 0 : _this$_store.key();\n  },\n  totalCount() {\n    return this._totalCount;\n  },\n  isLoaded() {\n    return this._isLoaded;\n  },\n  isLoading() {\n    return this._loadingCount > 0;\n  },\n  beginLoading() {\n    this._changeLoadingCount(1);\n  },\n  endLoading() {\n    this._changeLoadingCount(-1);\n  },\n  _createLoadQueue: () => create(),\n  _changeLoadingCount(increment) {\n    const oldLoading = this.isLoading();\n    this._loadingCount += increment;\n    const newLoading = this.isLoading();\n    if (oldLoading ^ newLoading) {\n      this._eventsStrategy.fireEvent(\"loadingChanged\", [newLoading]);\n    }\n  },\n  _scheduleLoadCallbacks(deferred) {\n    this.beginLoading();\n    deferred.always(() => {\n      this.endLoading();\n    });\n  },\n  _scheduleFailCallbacks(deferred) {\n    var _this = this;\n    deferred.fail(function () {\n      for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n        args[_key4] = arguments[_key4];\n      }\n      if (args[0] === CANCELED_TOKEN) {\n        return;\n      }\n      _this._eventsStrategy.fireEvent(\"loadError\", args);\n    });\n  },\n  _fireChanged(args) {\n    const date = new Date();\n    this._eventsStrategy.fireEvent(\"changed\", args);\n    this._changedTime = new Date() - date;\n  },\n  _scheduleChangedCallbacks(deferred) {\n    deferred.done(() => this._fireChanged());\n  },\n  loadSingle(propName, propValue) {\n    const d = new Deferred();\n    const key = this.key();\n    const store = this._store;\n    const options = this._createStoreLoadOptions();\n    this._scheduleFailCallbacks(d);\n    if (arguments.length < 2) {\n      propValue = propName;\n      propName = key;\n    }\n    delete options.skip;\n    delete options.group;\n    delete options.refresh;\n    delete options.pageIndex;\n    delete options.searchString;\n    (() => {\n      if (propName === key || store instanceof CustomStore && !store._byKeyViaLoad()) {\n        return store.byKey(propValue, options);\n      }\n      options.take = 1;\n      options.filter = options.filter ? [options.filter, [propName, propValue]] : [propName, propValue];\n      return store.load(options);\n    })().fail(d.reject).done(data => {\n      const isEmptyArray = Array.isArray(data) && !data.length;\n      if (!isDefined(data) || isEmptyArray) {\n        d.reject(errors.Error(\"E4009\"));\n      } else {\n        if (!Array.isArray(data)) {\n          data = [data];\n        }\n        d.resolve(this._applyMapFunction(data)[0]);\n      }\n    });\n    return d.promise();\n  },\n  load() {\n    const d = new Deferred();\n    const loadTask = () => {\n      if (this._disposed) {\n        return;\n      }\n      if (!isPending(d)) {\n        return;\n      }\n      return this._loadFromStore(loadOperation, d);\n    };\n    this._scheduleLoadCallbacks(d);\n    this._scheduleFailCallbacks(d);\n    this._scheduleChangedCallbacks(d);\n    const loadOperation = this._createLoadOperation(d);\n    this._eventsStrategy.fireEvent(\"customizeStoreLoadOptions\", [loadOperation]);\n    this._loadQueue.add(() => {\n      if (\"number\" === typeof loadOperation.delay) {\n        this._delayedLoadTask = commonUtils.executeAsync(loadTask, loadOperation.delay);\n      } else {\n        loadTask();\n      }\n      return d.promise();\n    });\n    return d.promise({\n      operationId: loadOperation.operationId\n    });\n  },\n  _onPush(changes) {\n    if (this._reshapeOnPush) {\n      this.load();\n    } else {\n      const changingArgs = {\n        changes: changes\n      };\n      this._eventsStrategy.fireEvent(\"changing\", [changingArgs]);\n      const group = this.group();\n      const items = this.items();\n      let groupLevel = 0;\n      let dataSourceChanges = this.paginate() || group ? changes.filter(item => \"update\" === item.type) : changes;\n      if (group) {\n        groupLevel = Array.isArray(group) ? group.length : 1;\n      }\n      if (this._mapFunc) {\n        dataSourceChanges.forEach(item => {\n          if (\"insert\" === item.type) {\n            item.data = this._mapFunc(item.data);\n          }\n        });\n      }\n      if (changingArgs.postProcessChanges) {\n        dataSourceChanges = changingArgs.postProcessChanges(dataSourceChanges);\n      }\n      applyBatch({\n        keyInfo: this.store(),\n        data: items,\n        changes: dataSourceChanges,\n        groupCount: groupLevel,\n        useInsertIndex: true\n      });\n      this._fireChanged([{\n        changes: changes\n      }]);\n    }\n  },\n  _createLoadOperation(deferred) {\n    const operationId = this._operationManager.add(deferred);\n    const storeLoadOptions = this._createStoreLoadOptions();\n    if (this._store && !isEmptyObject(null === storeLoadOptions || void 0 === storeLoadOptions ? void 0 : storeLoadOptions.langParams)) {\n      this._store._langParams = _extends({}, this._store._langParams, storeLoadOptions.langParams);\n    }\n    deferred.always(() => this._operationManager.remove(operationId));\n    return {\n      operationId: operationId,\n      storeLoadOptions: storeLoadOptions\n    };\n  },\n  reload() {\n    const store = this.store();\n    store._clearCache();\n    this._init();\n    return this.load();\n  },\n  cancel(operationId) {\n    return this._operationManager.cancel(operationId);\n  },\n  cancelAll() {\n    return this._operationManager.cancelAll();\n  },\n  _addSearchOptions(storeLoadOptions) {\n    if (this._disposed) {\n      return;\n    }\n    if (this.store()._useDefaultSearch) {\n      this._addSearchFilter(storeLoadOptions);\n    } else {\n      storeLoadOptions.searchOperation = this._searchOperation;\n      storeLoadOptions.searchValue = this._searchValue;\n      storeLoadOptions.searchExpr = this._searchExpr;\n    }\n  },\n  _createStoreLoadOptions() {\n    const result = extend({}, this._storeLoadOptions);\n    this._addSearchOptions(result);\n    if (this._paginate) {\n      if (this._pageSize) {\n        result.skip = this._pageIndex * this._pageSize;\n        result.take = this._pageSize;\n      }\n    }\n    result.userData = this._userData;\n    return result;\n  },\n  _addSearchFilter(storeLoadOptions) {\n    const value = this._searchValue;\n    const op = this._searchOperation;\n    let selector = this._searchExpr;\n    const searchFilter = [];\n    if (!value) {\n      return;\n    }\n    if (!selector) {\n      selector = \"this\";\n    }\n    if (!Array.isArray(selector)) {\n      selector = [selector];\n    }\n    each(selector, (i, item) => {\n      if (searchFilter.length) {\n        searchFilter.push(\"or\");\n      }\n      searchFilter.push([item, op, value]);\n    });\n    if (storeLoadOptions.filter) {\n      storeLoadOptions.filter = [searchFilter, storeLoadOptions.filter];\n    } else {\n      storeLoadOptions.filter = searchFilter;\n    }\n  },\n  _loadFromStore(loadOptions, pendingDeferred) {\n    const handleSuccess = (data, extra) => {\n      if (this._disposed) {\n        return;\n      }\n      if (!isPending(pendingDeferred)) {\n        return;\n      }\n      const loadResult = extend(normalizeLoadResult(data, extra), loadOptions);\n      this._eventsStrategy.fireEvent(\"customizeLoadResult\", [loadResult]);\n      when(loadResult.data).done(data => {\n        loadResult.data = data;\n        this._processStoreLoadResult(loadResult, pendingDeferred);\n      }).fail(pendingDeferred.reject);\n    };\n    if (loadOptions.data) {\n      return new Deferred().resolve(loadOptions.data).done(handleSuccess);\n    }\n    return this.store().load(loadOptions.storeLoadOptions).done(handleSuccess).fail(pendingDeferred.reject);\n  },\n  _processStoreLoadResult(loadResult, pendingDeferred) {\n    let {\n      data: data\n    } = loadResult;\n    let {\n      extra: extra\n    } = loadResult;\n    const {\n      storeLoadOptions: storeLoadOptions\n    } = loadResult;\n    const resolvePendingDeferred = () => {\n      this._isLoaded = true;\n      this._totalCount = isFinite(extra.totalCount) ? extra.totalCount : -1;\n      return pendingDeferred.resolve(data, extra);\n    };\n    const proceedLoadingTotalCount = () => {\n      this.store().totalCount(storeLoadOptions).done(count => {\n        extra.totalCount = count;\n        resolvePendingDeferred();\n      }).fail(pendingDeferred.reject);\n    };\n    if (this._disposed) {\n      return;\n    }\n    data = this._applyPostProcessFunction(this._applyMapFunction(data));\n    if (!isObject(extra)) {\n      extra = {};\n    }\n    this._items = data;\n    if (!data.length || !this._paginate || this._pageSize && data.length < this._pageSize) {\n      this._isLastPage = true;\n    }\n    if (storeLoadOptions.requireTotalCount && !isFinite(extra.totalCount)) {\n      proceedLoadingTotalCount();\n    } else {\n      resolvePendingDeferred();\n    }\n  },\n  _applyMapFunction(data) {\n    if (this._mapFunc) {\n      return mapDataRespectingGrouping(data, this._mapFunc, this.group());\n    }\n    return data;\n  },\n  _applyPostProcessFunction(data) {\n    if (this._postProcessFunc) {\n      return this._postProcessFunc(data);\n    }\n    return data;\n  },\n  on(eventName, eventHandler) {\n    this._eventsStrategy.on(eventName, eventHandler);\n    return this;\n  },\n  off(eventName, eventHandler) {\n    this._eventsStrategy.off(eventName, eventHandler);\n    return this;\n  }\n});","map":{"version":3,"names":["_extends","applyBatch","CustomStore","OperationManager","CANCELED_TOKEN","isPending","mapDataRespectingGrouping","normalizeDataSourceOptions","normalizeLoadResult","normalizeStoreLoadOptionAccessorArguments","errors","throttleChanges","Class","EventsStrategy","Deferred","when","extend","each","create","isBoolean","isDefined","isEmptyObject","isNumeric","isObject","isString","commonUtils","DataSource","inherit","ctor","options","_eventsStrategy","syncStrategy","_store","store","_changedTime","needThrottling","pushAggregationTimeout","throttlingTimeout","pushDeferred","lastPushWaiters","throttlingPushHandler","changes","resolve","storePushPending","done","_onPush","_onPushHandler","args","_aggregationTimeoutId","waitFor","push","promise","on","_storeLoadOptions","_extractLoadOptions","_mapFunc","map","_postProcessFunc","postProcess","_pageIndex","pageIndex","_pageSize","pageSize","_loadingCount","_loadQueue","_createLoadQueue","_searchValue","searchValue","_searchOperation","searchOperation","_searchExpr","searchExpr","_paginate","paginate","_reshapeOnPush","reshapeOnPush","_","optionName","substr","toLowerCase","_operationManager","_init","_items","_userData","_totalCount","_isLoaded","group","_isLastPage","dispose","_this$_delayedLoadTas","off","clearTimeout","_delayedLoadTask","abort","cancelAll","_disposed","result","names","customNames","_customLoadOptions","concat","loadOptions","items","newIndex","value","isLastPage","generateStoreLoadOptionAccessor","normalizedArgs","sort","_len","arguments","length","Array","_key","filter","newFilter","_len2","_key2","select","_len3","_key3","requireTotalCount","op","expr","argc","slice","call","key","_this$_store","totalCount","isLoaded","isLoading","beginLoading","_changeLoadingCount","endLoading","increment","oldLoading","newLoading","fireEvent","_scheduleLoadCallbacks","deferred","always","_scheduleFailCallbacks","_this","fail","_len4","_key4","_fireChanged","date","Date","_scheduleChangedCallbacks","loadSingle","propName","propValue","d","_createStoreLoadOptions","skip","refresh","searchString","_byKeyViaLoad","byKey","take","load","reject","data","isEmptyArray","isArray","Error","_applyMapFunction","loadTask","_loadFromStore","loadOperation","_createLoadOperation","add","delay","executeAsync","operationId","changingArgs","groupLevel","dataSourceChanges","item","type","forEach","postProcessChanges","keyInfo","groupCount","useInsertIndex","storeLoadOptions","langParams","_langParams","remove","reload","_clearCache","cancel","_addSearchOptions","_useDefaultSearch","_addSearchFilter","userData","selector","searchFilter","i","pendingDeferred","handleSuccess","extra","loadResult","_processStoreLoadResult","resolvePendingDeferred","isFinite","proceedLoadingTotalCount","count","_applyPostProcessFunction","eventName","eventHandler"],"sources":["/home/nataf/Cours/world-cities-map/client/node_modules/devextreme/esm/__internal/data/data_source/m_data_source.js"],"sourcesContent":["/**\r\n * DevExtreme (esm/__internal/data/data_source/m_data_source.js)\r\n * Version: 24.2.7\r\n * Build date: Mon Apr 28 2025\r\n *\r\n * Copyright (c) 2012 - 2025 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\r\nimport {\r\n    applyBatch\r\n} from \"../../../common/data/array_utils\";\r\nimport {\r\n    CustomStore\r\n} from \"../../../common/data/custom_store\";\r\nimport OperationManager from \"../../../common/data/data_source/operation_manager\";\r\nimport {\r\n    CANCELED_TOKEN,\r\n    isPending,\r\n    mapDataRespectingGrouping,\r\n    normalizeDataSourceOptions,\r\n    normalizeLoadResult,\r\n    normalizeStoreLoadOptionAccessorArguments\r\n} from \"../../../common/data/data_source/utils\";\r\nimport {\r\n    errors\r\n} from \"../../../common/data/errors\";\r\nimport {\r\n    throttleChanges\r\n} from \"../../../common/data/utils\";\r\nimport Class from \"../../../core/class\";\r\nimport {\r\n    EventsStrategy\r\n} from \"../../../core/events_strategy\";\r\nimport {\r\n    Deferred,\r\n    when\r\n} from \"../../../core/utils/deferred\";\r\nimport {\r\n    extend\r\n} from \"../../../core/utils/extend\";\r\nimport {\r\n    each\r\n} from \"../../../core/utils/iterator\";\r\nimport {\r\n    create\r\n} from \"../../../core/utils/queue\";\r\nimport {\r\n    isBoolean,\r\n    isDefined,\r\n    isEmptyObject,\r\n    isNumeric,\r\n    isObject,\r\n    isString\r\n} from \"../../../core/utils/type\";\r\nimport commonUtils from \"../../core/utils/m_common\";\r\nexport const DataSource = Class.inherit({\r\n    ctor(options) {\r\n        options = normalizeDataSourceOptions(options);\r\n        this._eventsStrategy = new EventsStrategy(this, {\r\n            syncStrategy: true\r\n        });\r\n        this._store = options.store;\r\n        this._changedTime = 0;\r\n        const needThrottling = 0 !== options.pushAggregationTimeout;\r\n        if (needThrottling) {\r\n            const throttlingTimeout = void 0 === options.pushAggregationTimeout ? () => 5 * this._changedTime : options.pushAggregationTimeout;\r\n            let pushDeferred;\r\n            let lastPushWaiters;\r\n            const throttlingPushHandler = throttleChanges((changes => {\r\n                pushDeferred.resolve();\r\n                const storePushPending = when(...lastPushWaiters);\r\n                storePushPending.done((() => this._onPush(changes)));\r\n                lastPushWaiters = void 0;\r\n                pushDeferred = void 0\r\n            }), throttlingTimeout);\r\n            this._onPushHandler = args => {\r\n                this._aggregationTimeoutId = throttlingPushHandler(args.changes);\r\n                if (!pushDeferred) {\r\n                    pushDeferred = new Deferred\r\n                }\r\n                lastPushWaiters = args.waitFor;\r\n                args.waitFor.push(pushDeferred.promise())\r\n            };\r\n            this._store.on(\"beforePushAggregation\", this._onPushHandler)\r\n        } else {\r\n            this._onPushHandler = changes => this._onPush(changes);\r\n            this._store.on(\"push\", this._onPushHandler)\r\n        }\r\n        this._storeLoadOptions = this._extractLoadOptions(options);\r\n        this._mapFunc = options.map;\r\n        this._postProcessFunc = options.postProcess;\r\n        this._pageIndex = void 0 !== options.pageIndex ? options.pageIndex : 0;\r\n        this._pageSize = void 0 !== options.pageSize ? options.pageSize : 20;\r\n        this._loadingCount = 0;\r\n        this._loadQueue = this._createLoadQueue();\r\n        this._searchValue = \"searchValue\" in options ? options.searchValue : null;\r\n        this._searchOperation = options.searchOperation || \"contains\";\r\n        this._searchExpr = options.searchExpr;\r\n        this._paginate = options.paginate;\r\n        this._reshapeOnPush = options.reshapeOnPush ?? false;\r\n        each([\"onChanged\", \"onLoadError\", \"onLoadingChanged\", \"onCustomizeLoadResult\", \"onCustomizeStoreLoadOptions\"], ((_, optionName) => {\r\n            if (optionName in options) {\r\n                this.on(optionName.substr(2, 1).toLowerCase() + optionName.substr(3), options[optionName])\r\n            }\r\n        }));\r\n        this._operationManager = new OperationManager;\r\n        this._init()\r\n    },\r\n    _init() {\r\n        this._items = [];\r\n        this._userData = {};\r\n        this._totalCount = -1;\r\n        this._isLoaded = false;\r\n        if (!isDefined(this._paginate)) {\r\n            this._paginate = !this.group()\r\n        }\r\n        this._isLastPage = !this._paginate\r\n    },\r\n    dispose() {\r\n        var _this$_delayedLoadTas;\r\n        this._store.off(\"beforePushAggregation\", this._onPushHandler);\r\n        this._store.off(\"push\", this._onPushHandler);\r\n        this._eventsStrategy.dispose();\r\n        clearTimeout(this._aggregationTimeoutId);\r\n        null === (_this$_delayedLoadTas = this._delayedLoadTask) || void 0 === _this$_delayedLoadTas || _this$_delayedLoadTas.abort();\r\n        this._operationManager.cancelAll();\r\n        delete this._store;\r\n        delete this._items;\r\n        delete this._delayedLoadTask;\r\n        this._disposed = true\r\n    },\r\n    _extractLoadOptions(options) {\r\n        const result = {};\r\n        let names = [\"sort\", \"filter\", \"langParams\", \"select\", \"group\", \"requireTotalCount\"];\r\n        const customNames = this._store._customLoadOptions();\r\n        if (customNames) {\r\n            names = names.concat(customNames)\r\n        }\r\n        each(names, (function() {\r\n            result[this] = options[this]\r\n        }));\r\n        return result\r\n    },\r\n    loadOptions() {\r\n        return this._storeLoadOptions\r\n    },\r\n    items() {\r\n        return this._items\r\n    },\r\n    pageIndex(newIndex) {\r\n        if (!isNumeric(newIndex)) {\r\n            return this._pageIndex\r\n        }\r\n        this._pageIndex = newIndex;\r\n        this._isLastPage = !this._paginate\r\n    },\r\n    paginate(value) {\r\n        if (!isBoolean(value)) {\r\n            return this._paginate\r\n        }\r\n        if (this._paginate !== value) {\r\n            this._paginate = value;\r\n            this.pageIndex(0)\r\n        }\r\n    },\r\n    pageSize(value) {\r\n        if (!isNumeric(value)) {\r\n            return this._pageSize\r\n        }\r\n        this._pageSize = value\r\n    },\r\n    isLastPage() {\r\n        return this._isLastPage\r\n    },\r\n    generateStoreLoadOptionAccessor(optionName) {\r\n        return args => {\r\n            const normalizedArgs = normalizeStoreLoadOptionAccessorArguments(args);\r\n            if (void 0 === normalizedArgs) {\r\n                return this._storeLoadOptions[optionName]\r\n            }\r\n            this._storeLoadOptions[optionName] = normalizedArgs\r\n        }\r\n    },\r\n    sort() {\r\n        for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\r\n            args[_key] = arguments[_key]\r\n        }\r\n        return this.generateStoreLoadOptionAccessor(\"sort\")(args)\r\n    },\r\n    filter() {\r\n        const newFilter = normalizeStoreLoadOptionAccessorArguments(arguments);\r\n        if (void 0 === newFilter) {\r\n            return this._storeLoadOptions.filter\r\n        }\r\n        this._storeLoadOptions.filter = newFilter;\r\n        this.pageIndex(0)\r\n    },\r\n    group() {\r\n        for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\r\n            args[_key2] = arguments[_key2]\r\n        }\r\n        return this.generateStoreLoadOptionAccessor(\"group\")(args)\r\n    },\r\n    select() {\r\n        for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\r\n            args[_key3] = arguments[_key3]\r\n        }\r\n        return this.generateStoreLoadOptionAccessor(\"select\")(args)\r\n    },\r\n    requireTotalCount(value) {\r\n        if (!isBoolean(value)) {\r\n            return this._storeLoadOptions.requireTotalCount\r\n        }\r\n        this._storeLoadOptions.requireTotalCount = value\r\n    },\r\n    searchValue(value) {\r\n        if (arguments.length < 1) {\r\n            return this._searchValue\r\n        }\r\n        this._searchValue = value;\r\n        this.pageIndex(0)\r\n    },\r\n    searchOperation(op) {\r\n        if (!isString(op)) {\r\n            return this._searchOperation\r\n        }\r\n        this._searchOperation = op;\r\n        this.pageIndex(0)\r\n    },\r\n    searchExpr(expr) {\r\n        const argc = arguments.length;\r\n        if (0 === argc) {\r\n            return this._searchExpr\r\n        }\r\n        if (argc > 1) {\r\n            expr = [].slice.call(arguments)\r\n        }\r\n        this._searchExpr = expr;\r\n        this.pageIndex(0)\r\n    },\r\n    store() {\r\n        return this._store\r\n    },\r\n    key() {\r\n        var _this$_store;\r\n        return null === (_this$_store = this._store) || void 0 === _this$_store ? void 0 : _this$_store.key()\r\n    },\r\n    totalCount() {\r\n        return this._totalCount\r\n    },\r\n    isLoaded() {\r\n        return this._isLoaded\r\n    },\r\n    isLoading() {\r\n        return this._loadingCount > 0\r\n    },\r\n    beginLoading() {\r\n        this._changeLoadingCount(1)\r\n    },\r\n    endLoading() {\r\n        this._changeLoadingCount(-1)\r\n    },\r\n    _createLoadQueue: () => create(),\r\n    _changeLoadingCount(increment) {\r\n        const oldLoading = this.isLoading();\r\n        this._loadingCount += increment;\r\n        const newLoading = this.isLoading();\r\n        if (oldLoading ^ newLoading) {\r\n            this._eventsStrategy.fireEvent(\"loadingChanged\", [newLoading])\r\n        }\r\n    },\r\n    _scheduleLoadCallbacks(deferred) {\r\n        this.beginLoading();\r\n        deferred.always((() => {\r\n            this.endLoading()\r\n        }))\r\n    },\r\n    _scheduleFailCallbacks(deferred) {\r\n        var _this = this;\r\n        deferred.fail((function() {\r\n            for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\r\n                args[_key4] = arguments[_key4]\r\n            }\r\n            if (args[0] === CANCELED_TOKEN) {\r\n                return\r\n            }\r\n            _this._eventsStrategy.fireEvent(\"loadError\", args)\r\n        }))\r\n    },\r\n    _fireChanged(args) {\r\n        const date = new Date;\r\n        this._eventsStrategy.fireEvent(\"changed\", args);\r\n        this._changedTime = new Date - date\r\n    },\r\n    _scheduleChangedCallbacks(deferred) {\r\n        deferred.done((() => this._fireChanged()))\r\n    },\r\n    loadSingle(propName, propValue) {\r\n        const d = new Deferred;\r\n        const key = this.key();\r\n        const store = this._store;\r\n        const options = this._createStoreLoadOptions();\r\n        this._scheduleFailCallbacks(d);\r\n        if (arguments.length < 2) {\r\n            propValue = propName;\r\n            propName = key\r\n        }\r\n        delete options.skip;\r\n        delete options.group;\r\n        delete options.refresh;\r\n        delete options.pageIndex;\r\n        delete options.searchString;\r\n        (() => {\r\n            if (propName === key || store instanceof CustomStore && !store._byKeyViaLoad()) {\r\n                return store.byKey(propValue, options)\r\n            }\r\n            options.take = 1;\r\n            options.filter = options.filter ? [options.filter, [propName, propValue]] : [propName, propValue];\r\n            return store.load(options)\r\n        })().fail(d.reject).done((data => {\r\n            const isEmptyArray = Array.isArray(data) && !data.length;\r\n            if (!isDefined(data) || isEmptyArray) {\r\n                d.reject(errors.Error(\"E4009\"))\r\n            } else {\r\n                if (!Array.isArray(data)) {\r\n                    data = [data]\r\n                }\r\n                d.resolve(this._applyMapFunction(data)[0])\r\n            }\r\n        }));\r\n        return d.promise()\r\n    },\r\n    load() {\r\n        const d = new Deferred;\r\n        const loadTask = () => {\r\n            if (this._disposed) {\r\n                return\r\n            }\r\n            if (!isPending(d)) {\r\n                return\r\n            }\r\n            return this._loadFromStore(loadOperation, d)\r\n        };\r\n        this._scheduleLoadCallbacks(d);\r\n        this._scheduleFailCallbacks(d);\r\n        this._scheduleChangedCallbacks(d);\r\n        const loadOperation = this._createLoadOperation(d);\r\n        this._eventsStrategy.fireEvent(\"customizeStoreLoadOptions\", [loadOperation]);\r\n        this._loadQueue.add((() => {\r\n            if (\"number\" === typeof loadOperation.delay) {\r\n                this._delayedLoadTask = commonUtils.executeAsync(loadTask, loadOperation.delay)\r\n            } else {\r\n                loadTask()\r\n            }\r\n            return d.promise()\r\n        }));\r\n        return d.promise({\r\n            operationId: loadOperation.operationId\r\n        })\r\n    },\r\n    _onPush(changes) {\r\n        if (this._reshapeOnPush) {\r\n            this.load()\r\n        } else {\r\n            const changingArgs = {\r\n                changes: changes\r\n            };\r\n            this._eventsStrategy.fireEvent(\"changing\", [changingArgs]);\r\n            const group = this.group();\r\n            const items = this.items();\r\n            let groupLevel = 0;\r\n            let dataSourceChanges = this.paginate() || group ? changes.filter((item => \"update\" === item.type)) : changes;\r\n            if (group) {\r\n                groupLevel = Array.isArray(group) ? group.length : 1\r\n            }\r\n            if (this._mapFunc) {\r\n                dataSourceChanges.forEach((item => {\r\n                    if (\"insert\" === item.type) {\r\n                        item.data = this._mapFunc(item.data)\r\n                    }\r\n                }))\r\n            }\r\n            if (changingArgs.postProcessChanges) {\r\n                dataSourceChanges = changingArgs.postProcessChanges(dataSourceChanges)\r\n            }\r\n            applyBatch({\r\n                keyInfo: this.store(),\r\n                data: items,\r\n                changes: dataSourceChanges,\r\n                groupCount: groupLevel,\r\n                useInsertIndex: true\r\n            });\r\n            this._fireChanged([{\r\n                changes: changes\r\n            }])\r\n        }\r\n    },\r\n    _createLoadOperation(deferred) {\r\n        const operationId = this._operationManager.add(deferred);\r\n        const storeLoadOptions = this._createStoreLoadOptions();\r\n        if (this._store && !isEmptyObject(null === storeLoadOptions || void 0 === storeLoadOptions ? void 0 : storeLoadOptions.langParams)) {\r\n            this._store._langParams = _extends({}, this._store._langParams, storeLoadOptions.langParams)\r\n        }\r\n        deferred.always((() => this._operationManager.remove(operationId)));\r\n        return {\r\n            operationId: operationId,\r\n            storeLoadOptions: storeLoadOptions\r\n        }\r\n    },\r\n    reload() {\r\n        const store = this.store();\r\n        store._clearCache();\r\n        this._init();\r\n        return this.load()\r\n    },\r\n    cancel(operationId) {\r\n        return this._operationManager.cancel(operationId)\r\n    },\r\n    cancelAll() {\r\n        return this._operationManager.cancelAll()\r\n    },\r\n    _addSearchOptions(storeLoadOptions) {\r\n        if (this._disposed) {\r\n            return\r\n        }\r\n        if (this.store()._useDefaultSearch) {\r\n            this._addSearchFilter(storeLoadOptions)\r\n        } else {\r\n            storeLoadOptions.searchOperation = this._searchOperation;\r\n            storeLoadOptions.searchValue = this._searchValue;\r\n            storeLoadOptions.searchExpr = this._searchExpr\r\n        }\r\n    },\r\n    _createStoreLoadOptions() {\r\n        const result = extend({}, this._storeLoadOptions);\r\n        this._addSearchOptions(result);\r\n        if (this._paginate) {\r\n            if (this._pageSize) {\r\n                result.skip = this._pageIndex * this._pageSize;\r\n                result.take = this._pageSize\r\n            }\r\n        }\r\n        result.userData = this._userData;\r\n        return result\r\n    },\r\n    _addSearchFilter(storeLoadOptions) {\r\n        const value = this._searchValue;\r\n        const op = this._searchOperation;\r\n        let selector = this._searchExpr;\r\n        const searchFilter = [];\r\n        if (!value) {\r\n            return\r\n        }\r\n        if (!selector) {\r\n            selector = \"this\"\r\n        }\r\n        if (!Array.isArray(selector)) {\r\n            selector = [selector]\r\n        }\r\n        each(selector, ((i, item) => {\r\n            if (searchFilter.length) {\r\n                searchFilter.push(\"or\")\r\n            }\r\n            searchFilter.push([item, op, value])\r\n        }));\r\n        if (storeLoadOptions.filter) {\r\n            storeLoadOptions.filter = [searchFilter, storeLoadOptions.filter]\r\n        } else {\r\n            storeLoadOptions.filter = searchFilter\r\n        }\r\n    },\r\n    _loadFromStore(loadOptions, pendingDeferred) {\r\n        const handleSuccess = (data, extra) => {\r\n            if (this._disposed) {\r\n                return\r\n            }\r\n            if (!isPending(pendingDeferred)) {\r\n                return\r\n            }\r\n            const loadResult = extend(normalizeLoadResult(data, extra), loadOptions);\r\n            this._eventsStrategy.fireEvent(\"customizeLoadResult\", [loadResult]);\r\n            when(loadResult.data).done((data => {\r\n                loadResult.data = data;\r\n                this._processStoreLoadResult(loadResult, pendingDeferred)\r\n            })).fail(pendingDeferred.reject)\r\n        };\r\n        if (loadOptions.data) {\r\n            return (new Deferred).resolve(loadOptions.data).done(handleSuccess)\r\n        }\r\n        return this.store().load(loadOptions.storeLoadOptions).done(handleSuccess).fail(pendingDeferred.reject)\r\n    },\r\n    _processStoreLoadResult(loadResult, pendingDeferred) {\r\n        let {\r\n            data: data\r\n        } = loadResult;\r\n        let {\r\n            extra: extra\r\n        } = loadResult;\r\n        const {\r\n            storeLoadOptions: storeLoadOptions\r\n        } = loadResult;\r\n        const resolvePendingDeferred = () => {\r\n            this._isLoaded = true;\r\n            this._totalCount = isFinite(extra.totalCount) ? extra.totalCount : -1;\r\n            return pendingDeferred.resolve(data, extra)\r\n        };\r\n        const proceedLoadingTotalCount = () => {\r\n            this.store().totalCount(storeLoadOptions).done((count => {\r\n                extra.totalCount = count;\r\n                resolvePendingDeferred()\r\n            })).fail(pendingDeferred.reject)\r\n        };\r\n        if (this._disposed) {\r\n            return\r\n        }\r\n        data = this._applyPostProcessFunction(this._applyMapFunction(data));\r\n        if (!isObject(extra)) {\r\n            extra = {}\r\n        }\r\n        this._items = data;\r\n        if (!data.length || !this._paginate || this._pageSize && data.length < this._pageSize) {\r\n            this._isLastPage = true\r\n        }\r\n        if (storeLoadOptions.requireTotalCount && !isFinite(extra.totalCount)) {\r\n            proceedLoadingTotalCount()\r\n        } else {\r\n            resolvePendingDeferred()\r\n        }\r\n    },\r\n    _applyMapFunction(data) {\r\n        if (this._mapFunc) {\r\n            return mapDataRespectingGrouping(data, this._mapFunc, this.group())\r\n        }\r\n        return data\r\n    },\r\n    _applyPostProcessFunction(data) {\r\n        if (this._postProcessFunc) {\r\n            return this._postProcessFunc(data)\r\n        }\r\n        return data\r\n    },\r\n    on(eventName, eventHandler) {\r\n        this._eventsStrategy.on(eventName, eventHandler);\r\n        return this\r\n    },\r\n    off(eventName, eventHandler) {\r\n        this._eventsStrategy.off(eventName, eventHandler);\r\n        return this\r\n    }\r\n});\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}