{"ast":null,"code":"/**\r\n * DevExtreme (esm/__internal/data/m_remote_query.js)\r\n * Version: 24.2.7\r\n * Build date: Mon Apr 28 2025\r\n *\r\n * Copyright (c) 2012 - 2025 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport arrayQueryImpl from \"../../common/data/array_query\";\nimport { errors, handleError } from \"../../common/data/errors\";\nimport queryAdapters from \"../../common/data/query_adapters\";\nimport { Deferred } from \"../../core/utils/deferred\";\nimport { each } from \"../../core/utils/iterator\";\nimport { isFunction } from \"../../core/utils/type\";\nconst remoteQueryImpl = function (url, queryOptions, tasks) {\n  tasks = tasks || [];\n  queryOptions = queryOptions || {};\n  const createTask = function (name, args) {\n    return {\n      name: name,\n      args: args\n    };\n  };\n  const exec = function (executorTask) {\n    const d = new Deferred();\n    let _adapterFactory;\n    let _adapter;\n    let _taskQueue;\n    let _currentTask;\n    let _mergedSortArgs;\n    const rejectWithNotify = function (error) {\n      const handler = queryOptions.errorHandler;\n      if (handler) {\n        handler(error);\n      }\n      handleError(error);\n      d.reject(error);\n    };\n    function mergeSortTask(task) {\n      switch (task.name) {\n        case \"sortBy\":\n          _mergedSortArgs = [task.args];\n          return true;\n        case \"thenBy\":\n          if (!_mergedSortArgs) {\n            throw errors.Error(\"E4004\");\n          }\n          _mergedSortArgs.push(task.args);\n          return true;\n      }\n      return false;\n    }\n    try {\n      _adapterFactory = queryOptions.adapter;\n      if (!isFunction(_adapterFactory)) {\n        _adapterFactory = queryAdapters[_adapterFactory];\n      }\n      _adapter = _adapterFactory(queryOptions);\n      _taskQueue = [].concat(tasks).concat(executorTask);\n      const {\n        optimize: optimize\n      } = _adapter;\n      if (optimize) {\n        optimize(_taskQueue);\n      }\n      while (_taskQueue.length) {\n        _currentTask = _taskQueue[0];\n        if (!mergeSortTask(_currentTask)) {\n          if (_mergedSortArgs) {\n            _taskQueue.unshift(createTask(\"multiSort\", [_mergedSortArgs]));\n            _mergedSortArgs = null;\n            continue;\n          }\n          if (\"enumerate\" !== String(_currentTask.name)) {\n            if (!_adapter[_currentTask.name] || false === _adapter[_currentTask.name].apply(_adapter, _currentTask.args)) {\n              break;\n            }\n          }\n        }\n        _taskQueue.shift();\n      }\n      !function () {\n        const head = _taskQueue[0];\n        const unmergedTasks = [];\n        if (head && \"multiSort\" === head.name) {\n          _taskQueue.shift();\n          each(head.args[0], function () {\n            unmergedTasks.push(createTask(unmergedTasks.length ? \"thenBy\" : \"sortBy\", this));\n          });\n        }\n        _taskQueue = unmergedTasks.concat(_taskQueue);\n      }();\n      _adapter.exec(url).done((result, extra) => {\n        if (!_taskQueue.length) {\n          d.resolve(result, extra);\n        } else {\n          let clientChain = arrayQueryImpl(result, {\n            errorHandler: queryOptions.errorHandler\n          });\n          each(_taskQueue, function () {\n            clientChain = clientChain[this.name].apply(clientChain, this.args);\n          });\n          clientChain.done(d.resolve).fail(d.reject);\n        }\n      }).fail(rejectWithNotify);\n    } catch (x) {\n      rejectWithNotify(x);\n    }\n    return d.promise();\n  };\n  const query = {};\n  each([\"sortBy\", \"thenBy\", \"filter\", \"slice\", \"select\", \"groupBy\"], function () {\n    const name = String(this);\n    query[name] = function () {\n      return remoteQueryImpl(url, queryOptions, tasks.concat(createTask(name, arguments)));\n    };\n  });\n  each([\"count\", \"min\", \"max\", \"sum\", \"avg\", \"aggregate\", \"enumerate\"], function () {\n    const name = String(this);\n    query[name] = function () {\n      return exec.call(this, createTask(name, arguments));\n    };\n  });\n  return query;\n};\nexport default remoteQueryImpl;","map":{"version":3,"names":["arrayQueryImpl","errors","handleError","queryAdapters","Deferred","each","isFunction","remoteQueryImpl","url","queryOptions","tasks","createTask","name","args","exec","executorTask","d","_adapterFactory","_adapter","_taskQueue","_currentTask","_mergedSortArgs","rejectWithNotify","error","handler","errorHandler","reject","mergeSortTask","task","Error","push","adapter","concat","optimize","length","unshift","String","apply","shift","head","unmergedTasks","done","result","extra","resolve","clientChain","fail","x","promise","query","arguments","call"],"sources":["/home/nataf/Cours/world-cities-map/client/node_modules/devextreme/esm/__internal/data/m_remote_query.js"],"sourcesContent":["/**\r\n * DevExtreme (esm/__internal/data/m_remote_query.js)\r\n * Version: 24.2.7\r\n * Build date: Mon Apr 28 2025\r\n *\r\n * Copyright (c) 2012 - 2025 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport arrayQueryImpl from \"../../common/data/array_query\";\r\nimport {\r\n    errors,\r\n    handleError\r\n} from \"../../common/data/errors\";\r\nimport queryAdapters from \"../../common/data/query_adapters\";\r\nimport {\r\n    Deferred\r\n} from \"../../core/utils/deferred\";\r\nimport {\r\n    each\r\n} from \"../../core/utils/iterator\";\r\nimport {\r\n    isFunction\r\n} from \"../../core/utils/type\";\r\nconst remoteQueryImpl = function(url, queryOptions, tasks) {\r\n    tasks = tasks || [];\r\n    queryOptions = queryOptions || {};\r\n    const createTask = function(name, args) {\r\n        return {\r\n            name: name,\r\n            args: args\r\n        }\r\n    };\r\n    const exec = function(executorTask) {\r\n        const d = new Deferred;\r\n        let _adapterFactory;\r\n        let _adapter;\r\n        let _taskQueue;\r\n        let _currentTask;\r\n        let _mergedSortArgs;\r\n        const rejectWithNotify = function(error) {\r\n            const handler = queryOptions.errorHandler;\r\n            if (handler) {\r\n                handler(error)\r\n            }\r\n            handleError(error);\r\n            d.reject(error)\r\n        };\r\n\r\n        function mergeSortTask(task) {\r\n            switch (task.name) {\r\n                case \"sortBy\":\r\n                    _mergedSortArgs = [task.args];\r\n                    return true;\r\n                case \"thenBy\":\r\n                    if (!_mergedSortArgs) {\r\n                        throw errors.Error(\"E4004\")\r\n                    }\r\n                    _mergedSortArgs.push(task.args);\r\n                    return true\r\n            }\r\n            return false\r\n        }\r\n        try {\r\n            _adapterFactory = queryOptions.adapter;\r\n            if (!isFunction(_adapterFactory)) {\r\n                _adapterFactory = queryAdapters[_adapterFactory]\r\n            }\r\n            _adapter = _adapterFactory(queryOptions);\r\n            _taskQueue = [].concat(tasks).concat(executorTask);\r\n            const {\r\n                optimize: optimize\r\n            } = _adapter;\r\n            if (optimize) {\r\n                optimize(_taskQueue)\r\n            }\r\n            while (_taskQueue.length) {\r\n                _currentTask = _taskQueue[0];\r\n                if (!mergeSortTask(_currentTask)) {\r\n                    if (_mergedSortArgs) {\r\n                        _taskQueue.unshift(createTask(\"multiSort\", [_mergedSortArgs]));\r\n                        _mergedSortArgs = null;\r\n                        continue\r\n                    }\r\n                    if (\"enumerate\" !== String(_currentTask.name)) {\r\n                        if (!_adapter[_currentTask.name] || false === _adapter[_currentTask.name].apply(_adapter, _currentTask.args)) {\r\n                            break\r\n                        }\r\n                    }\r\n                }\r\n                _taskQueue.shift()\r\n            }! function() {\r\n                const head = _taskQueue[0];\r\n                const unmergedTasks = [];\r\n                if (head && \"multiSort\" === head.name) {\r\n                    _taskQueue.shift();\r\n                    each(head.args[0], (function() {\r\n                        unmergedTasks.push(createTask(unmergedTasks.length ? \"thenBy\" : \"sortBy\", this))\r\n                    }))\r\n                }\r\n                _taskQueue = unmergedTasks.concat(_taskQueue)\r\n            }();\r\n            _adapter.exec(url).done(((result, extra) => {\r\n                if (!_taskQueue.length) {\r\n                    d.resolve(result, extra)\r\n                } else {\r\n                    let clientChain = arrayQueryImpl(result, {\r\n                        errorHandler: queryOptions.errorHandler\r\n                    });\r\n                    each(_taskQueue, (function() {\r\n                        clientChain = clientChain[this.name].apply(clientChain, this.args)\r\n                    }));\r\n                    clientChain.done(d.resolve).fail(d.reject)\r\n                }\r\n            })).fail(rejectWithNotify)\r\n        } catch (x) {\r\n            rejectWithNotify(x)\r\n        }\r\n        return d.promise()\r\n    };\r\n    const query = {};\r\n    each([\"sortBy\", \"thenBy\", \"filter\", \"slice\", \"select\", \"groupBy\"], (function() {\r\n        const name = String(this);\r\n        query[name] = function() {\r\n            return remoteQueryImpl(url, queryOptions, tasks.concat(createTask(name, arguments)))\r\n        }\r\n    }));\r\n    each([\"count\", \"min\", \"max\", \"sum\", \"avg\", \"aggregate\", \"enumerate\"], (function() {\r\n        const name = String(this);\r\n        query[name] = function() {\r\n            return exec.call(this, createTask(name, arguments))\r\n        }\r\n    }));\r\n    return query\r\n};\r\nexport default remoteQueryImpl;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}